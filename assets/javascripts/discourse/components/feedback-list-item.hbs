<div class="feedback-list-item">
  <div class="user-rating">
    <div class="user-data">
      <LinkTo @route="user" @model={{@feedback.user.username}}>
        {{avatar @feedback.user imageSize="large"}}
      </LinkTo>
      <div class="rating-data">
        <span class="username">{{@feedback.user.username}}</span>
        {{#if this.isEditing}}
          <RatingInput @value={{this.editRating}} @readOnly={{false}} @onChange={{this.updateRating}} />
        {{else}}
          <RatingInput @value={{@feedback.rating}} @readOnly={{true}} />
        {{/if}}
        {{#if @feedback.admin_modified}}
          <span class="admin-modified-indicator">
            {{d-icon "shield-alt"}} {{i18n "discourse_user_feedbacks.admin_modified"}}
          </span>
        {{/if}}
      </div>
    </div>
    <div class="feedback-meta">
      {{format-date @feedback.created_at format="medium"}}
      {{#if @feedback.admin_modified_at}}
        <br>
        <small class="admin-modified-text">
          {{i18n "discourse_user_feedbacks.modified_by_admin"}} 
          {{@feedback.admin_modified_by.username}} 
          {{format-date @feedback.admin_modified_at format="tiny"}}
        </small>
      {{/if}}
      {{#if this.currentUser.admin}}
        <div class="admin-actions">
          {{#if this.isEditing}}
            <DButton
              @label={{i18n "discourse_user_feedbacks.save_feedback"}}
              @action={{this.saveEdit}}
              class="btn-primary btn-small"
            />
            <DButton
              @label={{i18n "discourse_user_feedbacks.cancel_edit"}}
              @action={{this.cancelEdit}}
              class="btn-small"
            />
          {{else}}
            <DButton
              @label={{i18n "discourse_user_feedbacks.edit_feedback"}}
              @action={{this.startEdit}}
              class="btn-small"
              @icon="pencil-alt"
            />
            <DButton
              @label={{i18n "discourse_user_feedbacks.delete_feedback"}}
              @action={{this.deleteFeedback}}
              class="btn-danger btn-small"
              @icon="trash-alt"
            />
          {{/if}}
        </div>
      {{/if}}
    </div>
  </div>
  {{#if this.isEditing}}
    <div class="edit-review">
      <Textarea
        @rows="3"
        @placeholder="Edit review..."
        @value={{this.editReview}}
        {{on "input" this.updateReview}}
        class="edit-review-textarea"
      />
    </div>
  {{else if @feedback.review}}
    <p class="feedback-review">
      {{html-safe @feedback.review}}
    </p>
  {{/if}}
  <hr>
</div>
